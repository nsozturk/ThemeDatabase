/* eslint-disable react-refresh/only-export-components */
import { createContext, useContext, useEffect, useMemo, useState, type PropsWithChildren } from 'react';

export type Locale = 'en' | 'tr' | 'de' | 'fr' | 'zh' | 'ja' | 'ko' | 'ar' | 'es' | 'pt' | 'hi';

interface I18nContextValue {
  locale: Locale;
  setLocale: (next: Locale) => void;
  t: (key: string, vars?: Record<string, string | number>) => string;
  formatNumber: (value: number) => string;
}

const RTL_LOCALES: Locale[] = ['ar'];

const LOCALE_LABELS: Record<Locale, string> = {
  en: 'English',
  tr: 'Türkçe',
  de: 'Deutsch',
  fr: 'Français',
  zh: '中文',
  ja: '日本語',
  ko: '한국어',
  ar: 'العربية',
  es: 'Español',
  pt: 'Português',
  hi: 'हिन्दी',
};

const NUMBER_LOCALE: Record<Locale, string> = {
  en: 'en-US',
  tr: 'tr-TR',
  de: 'de-DE',
  fr: 'fr-FR',
  zh: 'zh-CN',
  ja: 'ja-JP',
  ko: 'ko-KR',
  ar: 'ar-SA',
  es: 'es-ES',
  pt: 'pt-PT',
  hi: 'hi-IN',
};

const EN_MESSAGES: Record<string, string> = {
  'app.skipToContent': 'Skip to content',
  'app.loading': 'Loading…',
  'header.brandSubtitle': 'Global VS Code Theme Explorer',
  'header.motto': 'One Theme Database to rule them all.',
  'header.navMain': 'Main navigation',
  'header.navThemes': 'Themes',
  'header.navAbout': 'About',
  'header.navSupport': 'Support',
  'header.language': 'Language',
  'supportPopover.title': 'Support ThemeDatabase',
  'supportPopover.subtitle': 'Choose a platform and amount. This will open the provider in a new tab.',
  'supportPopover.methods': 'Support via',
  'supportPopover.amount': 'Amount',
  'supportPopover.custom': 'Custom amount',
  'supportPopover.send': 'Continue (${amount})',
  'supportPopover.note': 'Tip: if the provider does not support custom amounts via URL, pick a tier after opening.',
  'supportPopover.copiedAmount': 'Amount copied. Paste it into Buy Me a Coffee.',
  'supportPopover.copyFailed': 'Could not copy the amount. Please enter it on Buy Me a Coffee.',
  'supportPopover.needsUrl': 'Configure URL in supporters.json to enable.',
  'hero.title': 'Global Theme Database',
  'hero.subtitle': 'Pick any color from code and filter across the entire theme database.',
  'hero.language': 'Sample Programming Language',
  'homePreview.ariaLabel': 'Feature preview',
  'homePreview.close': 'Dismiss feature preview',
  'homePreview.pack.title': 'Theme Pack Builder',
  'homePreview.pack.body': 'Select up to 10 themes and export a single VSIX pack.',
  'homePreview.pack.meta': 'Pinned selection • One-click pack export',
  'homePreview.pack.cta': 'Open Pack Builder',
  'homePreview.export.title': 'Multi-target Export',
  'homePreview.export.body': 'Export the same theme for VS Code, JetBrains, Xcode, Vim, and Emacs.',
  'homePreview.export.meta': 'Strict 1:1 mapping • Per-field overrides',
  'homePreview.export.cta': 'Open Builder',
  'homePreview.export.ctaDisabledHint': 'Select a theme to open the builder.',
  'home.explorer': 'Theme Explorer',
  'home.filterResult': 'Filter result: {count} themes',
  'home.resetFilters': 'Reset Filters',
  'home.selected': 'Selected: {count}/{max}',
  'home.openPackBuilder': 'Theme Pack Builder',
  'home.selectedSection': 'Selected Themes',
  'home.clearSelected': 'Clear selection',
  'pack.title': 'Theme Pack Builder',
  'pack.subtitle': 'Export your selected themes into a single VSIX.',
  'pack.identityTitle': 'Extension identity',
  'pack.field.publisher': 'Publisher',
  'pack.field.version': 'Version',
  'pack.field.displayName': 'Display name',
  'pack.field.name': 'Name (unique id)',
  'pack.field.description': 'Description',
  'pack.emptyTitle': 'No themes selected',
  'pack.emptyBody': 'Select up to 10 themes in the explorer, then build a single VSIX pack here.',
  'pack.back': 'Back to Explorer',
  'pack.generate': 'Generate & Download VSIX',
  'pack.loading': 'Loading selected themes…',
  'pack.limitReached': 'You can select up to {max} themes.',
  'pack.includedTitle': 'Included themes',
  'pack.included': '{count} themes included',
  'pack.selectedTitle': 'Selected themes',
  'loading.shards': 'Shard loading: {loaded}/{total} ({ratio}%)',
  'card.details': 'Details',
  'card.vsixBuilder': 'VSIX Builder',
  'card.openDetail': 'Open details for {name}',
  'card.previewUnavailable': 'Preview unavailable',
  'card.select': 'Select {name}',
  'card.deselect': 'Deselect {name}',
  'filters.ariaLabel': 'Theme filters',
  'filters.search': 'Search',
  'filters.searchPlaceholder': 'Theme, publisher, description…',
  'filters.bgCategory': 'Background Category',
  'filters.tokenRole': 'Token Role',
  'filters.hex': 'HEX',
  'filters.openPalette': 'Open color palette',
  'filters.paletteTitle': 'Color Palette',
  'filters.close': 'Close',
  'filters.customColor': 'Custom Color',
  'filters.customColorAria': 'Pick custom color',
  'filters.tolerance': 'Tolerance {value}',
  'filters.sort': 'Sort',
  'filters.view': 'View',
  'filters.stats': '{filtered} / {total} themes',
  'filters.sort.name': 'Name',
  'filters.sort.publisher': 'Publisher',
  'filters.sort.background': 'Background',
  'filters.view.grid': 'Grid',
  'filters.view.list': 'List',
  'filters.token.any': 'Any Token',
  'filters.token.background': 'Background',
  'filters.token.keyword': 'Keyword',
  'filters.token.string': 'String',
  'filters.token.comment': 'Comment',
  'filters.token.function': 'Function',
  'filters.token.variable': 'Variable',
  'filters.token.number': 'Number',
  'filters.token.type': 'Type',
  'filters.token.operator': 'Operator',
  'filters.bg.all': 'all',
  'filters.bg.dark': 'dark',
  'filters.bg.light': 'light',
  'filters.bg.blue': 'blue',
  'filters.bg.purple': 'purple',
  'filters.bg.green': 'green',
  'filters.bg.orange': 'orange',
  'filters.bg.gray': 'gray',
  'filters.bg.mixed': 'mixed',
  'filters.palette.warm': 'Warm Tones',
  'filters.palette.cool': 'Cool Tones',
  'filters.palette.deep': 'Deep Tones',
  'filters.palette.neutral': 'Neutral Tones',
  'detail.loading': 'Loading theme detail…',
  'detail.notFound': 'Theme not found.',
  'detail.backToList': 'Back to list',
  'detail.exportVsix': 'Export VSIX',
  'detail.marketplace': 'Marketplace',
  'detail.previewLabel': 'IDE Preview',
  'detail.previewStatus': 'No diagnostics',
  'detail.tokenPalette': 'Token Palette',
  'detail.editorColors': 'Editor Colors',
  'detail.similarThemes': 'Similar Themes',
  'builder.loading': 'Builder data is loading…',
  'builder.payloadLoadFailed': 'VSIX payload could not be loaded.',
  'builder.themeOrPayloadNotFound': 'Theme or payload not found.',
  'builder.vsixBuildFailed': 'VSIX build failed.',
  'builder.livePreview': 'Live Preview',
  'builder.validJson': 'Valid JSON',
  'builder.needsFix': 'Needs Fix',
  'builder.previewManifest': 'Real-time view of your extension manifest.',
  'builder.previewExportPlan': 'Resolved mapping plan and included fields for this target.',
  'builder.marketplaceCard': 'MARKETPLACE CARD',
  'builder.noDescription': 'No description',
  'builder.themeCategory': 'Theme',
  'builder.configureTitle': 'Configure VSIX',
  'builder.configureSubtitle': 'Finalize your extension details and apply last-minute theme tweaks.',
  'builder.extensionIdentity': 'Extension Identity',
  'builder.publisherHandle': 'Publisher Handle',
  'builder.publisherHint': 'Must match your marketplace ID.',
  'builder.version': 'Version',
  'builder.displayName': 'Display Name',
  'builder.uniqueId': 'Unique ID (Name)',
  'builder.description': 'Description',
  'builder.categories': 'Categories',
  'builder.cat.themes': 'Themes',
  'builder.cat.snippets': 'Snippets',
  'builder.cat.packs': 'Extension Packs',
  'builder.quickTweaks': 'Quick Tweaks',
  'builder.resetDefaults': 'Reset to defaults',
  'builder.editorBackground': 'Editor Background',
  'builder.accentColor': 'Accent Color',
  'builder.backToEditor': 'Back to Editor',
  'builder.generate': 'Generate & Download VSIX',
  'builder.exportTarget': 'Export Target',
  'builder.target.vscode': 'VS Code (VSIX)',
  'builder.target.jetbrainsPlugin': 'JetBrains (Plugin .zip)',
  'builder.target.jetbrainsIcls': 'JetBrains (Scheme .icls)',
  'builder.target.xcode': 'Xcode (.dvtcolortheme)',
  'builder.target.xcodeXc': 'Xcode (.xccolortheme)',
  'builder.target.vim': 'Vim (.vim)',
  'builder.target.emacs': 'Emacs (theme.el)',
  'builder.exportPreview': 'Export Preview',
  'builder.configureExportTitle': 'Configure Export',
  'builder.configureExportSubtitle': 'Map theme parameters to a specific IDE format with strict 1:1 rules.',
  'builder.coverage': 'Exporting {included} fields, {excluded} unavailable',
  'builder.exportIdentity': 'Export Identity',
  'builder.exportDisplayName': 'Display Name',
  'builder.exportFilename': 'File Name (Slug)',
  'builder.exportFields': 'Export Fields',
  'builder.group.editor': 'Editor',
  'builder.group.syntax': 'Syntax',
  'builder.group.console': 'Console',
  'builder.fieldToggle': 'Toggle field {key}',
  'builder.fieldOverride': 'Override {key}',
  'builder.resetField': 'Reset',
  'builder.overridden': 'Overridden',
  'builder.mapped': 'Mapped',
  'builder.source': 'Source',
  'builder.alphaNotSupported': 'Alpha not supported for this target field.',
  'builder.invalidColor': 'Invalid color value.',
  'builder.exportPlanMissing': 'Export plan could not be generated.',
  'builder.overrideFixRequired': 'Fix invalid overrides before exporting.',
  'builder.exportBuildFailed': 'Export build failed.',
  'builder.generateExport': 'Generate & Download',
  'builder.packaging': 'Packaging…',
  'success.title': 'VSIX Package Ready!',
  'success.exportReady': 'Export Ready!',
  'success.generatedFor': '{name} package has been successfully generated.',
  'success.download': 'Download .vsix',
  'success.downloadFile': 'Download file',
  'success.versionSize': 'Version {version} • {size}',
  'success.source': 'Source: {mode}',
  'success.target.vscode-vsix': 'Target: VS Code',
  'success.target.jetbrains-plugin': 'Target: JetBrains Plugin',
  'success.target.jetbrains-icls': 'Target: JetBrains Scheme',
  'success.target.xcode-dvtcolortheme': 'Target: Xcode',
  'success.target.xcode-xccolortheme': 'Target: Xcode',
  'success.target.vim-colorscheme': 'Target: Vim',
  'success.target.emacs-theme': 'Target: Emacs',
  'success.installCli': 'Install via Command Line',
  'success.optional': 'Optional',
  'success.copy': 'Copy',
  'success.copied': 'Copied',
  'success.error': 'Error',
  'success.installGuide': 'Installation Guide',
  'success.installGuideSubtitle': 'Follow these steps to activate your theme locally.',
  'success.step1Title': 'Open VS Code',
  'success.step1Detail': 'Launch Visual Studio Code on your desktop.',
  'success.step2Title': 'Go to Extensions',
  'success.step2Detail': 'Open Extensions panel with Ctrl+Shift+X.',
  'success.step3Title': 'Open Views Menu',
  'success.step3Detail': 'Use the top-right menu in Extensions panel.',
  'success.step4Title': 'Install from VSIX',
  'success.step4Detail': 'Select "Install from VSIX..." and choose downloaded file.',
  'success.jetbrains.step1Title': 'Open JetBrains IDE',
  'success.jetbrains.step1Detail': 'Launch IntelliJ IDEA / WebStorm / PyCharm.',
  'success.jetbrains.step2Title': 'Open Plugins Settings',
  'success.jetbrains.step2Detail': 'Go to Settings/Preferences → Plugins.',
  'success.jetbrains.step3Title': 'Install from Disk',
  'success.jetbrains.step3Detail': 'Use the gear icon → "Install Plugin from Disk…".',
  'success.jetbrains.step4Title': 'Restart IDE',
  'success.jetbrains.step4Detail': 'Select downloaded .zip and restart the IDE.',
  'success.jetbrainsIcls.step1Title': 'Open Settings',
  'success.jetbrainsIcls.step1Detail': 'Go to Settings/Preferences → Editor → Color Scheme.',
  'success.jetbrainsIcls.step2Title': 'Import Scheme',
  'success.jetbrainsIcls.step2Detail': 'Use the scheme menu to import .icls file.',
  'success.jetbrainsIcls.step3Title': 'Apply Scheme',
  'success.jetbrainsIcls.step3Detail': 'Select the imported scheme in your IDE.',
  'success.xcode.step1Title': 'Copy Theme File',
  'success.xcode.step1Detail': 'Move the {ext} file into Xcode color themes folder.',
  'success.xcode.step2Title': 'Restart Xcode',
  'success.xcode.step2Detail': 'Restart Xcode to pick up the new theme.',
  'success.xcode.step3Title': 'Select Theme',
  'success.xcode.step3Detail': 'Xcode → Settings/Preferences → Fonts & Colors → choose the theme.',
  'success.vim.step1Title': 'Move Colorscheme',
  'success.vim.step1Detail': 'Place the .vim file in ~/.vim/colors/ or ~/.config/nvim/colors/.',
  'success.vim.step2Title': 'Enable',
  'success.vim.step2Detail': 'Add "colorscheme <name>" to your vimrc/init.vim.',
  'success.vim.step3Title': 'Reload',
  'success.vim.step3Detail': 'Restart Vim/Neovim or :source your config.',
  'success.emacs.step1Title': 'Move Theme',
  'success.emacs.step1Detail': 'Place the theme file in ~/.emacs.d/themes/.',
  'success.emacs.step2Title': 'Load Path',
  'success.emacs.step2Detail': 'Add the themes directory to load-path in your init file.',
  'success.emacs.step3Title': 'Load Theme',
  'success.emacs.step3Detail': 'Run (load-theme \'theme-name t) in Emacs.',
  'success.visualHint': 'Visual Hint',
  'success.visualHintDesc': 'VS Code Extension Menu',
  'success.backToExplorer': 'Back to Explorer',
  'success.viewDocs': 'View Documentation',
  'about.liveBadge': 'Live Indexing Status: Active',
  'about.heroCount': '22,000+',
  'about.heroSubtitle': 'Themes analyzed across the global VS Code ecosystem. We index every color key for precision matching.',
  'about.statExtensions': 'Extensions',
  'about.statColorKeys': 'Color Keys',
  'about.statDailyUpdates': 'Daily Updates',
  'about.statQueryTime': 'Query Time',
  'about.algorithmKicker': 'Algorithmic Core',
  'about.algorithmTitle': 'HSL Color Matching Engine',
  'about.algorithmBody': 'ThemeDatabase converts colors into HSL space and computes Delta-E distance for perceptually accurate results.',
  'about.engineDeltaTitle': 'Delta-E Calculation',
  'about.engineDeltaBody': 'CIE-style color distance matching for reliable visual similarity.',
  'about.enginePerceptualTitle': 'Perceptual Uniformity',
  'about.enginePerceptualBody': 'Matches how humans perceive contrast and luminance.',
  'about.blueprintInput': 'INPUT: #AF25F4',
  'about.blueprintMatch': '98.4% MATCH',
  'about.databaseKicker': 'The Database',
  'about.databaseTitle': 'Global Index',
  'about.extensionsTracked': 'Extensions Tracked',
  'about.colorKeysTracked': 'Color Keys',
  'about.performanceKicker': 'Performance Architecture',
  'about.performanceTitle': 'Meet the Engine',
  'about.performanceBody': 'Optimized for low-latency browsing with static shards and virtualized rendering.',
  'about.perfClientTitle': 'Client-Side Compute',
  'about.perfClientBody': 'Runs fully in the browser with no backend requirement.',
  'about.perfShardTitle': 'Sharded Data Loading',
  'about.perfShardBody': 'Loads only required chunks to keep first render fast.',
  'about.perfVirtualizedTitle': 'Virtualized Lists',
  'about.perfVirtualizedBody': 'Large result sets remain smooth while scrolling.',
  'about.licenseKicker': 'Open Source',
  'about.licenseTitle': 'MIT License',
  'about.licenseBody': 'This project is licensed under the MIT License for open use and modification.',
  'about.licenseBadge': 'MIT',
  'about.licenseView': 'View LICENSE',
  'support.kicker': 'Support',
  'support.title': 'Support ThemeDatabase',
  'support.body': 'Support keeps the dataset fresh, previews hosted, and new exporter targets shipping.',
  'support.cta': 'Support on Buy Me a Coffee',
  'support.tiersTitle': 'Membership Tiers',
  'support.thanksTitle': 'Thanks',
  'support.howTitle': 'How to get listed',
  'support.howBody': 'After supporting via Buy Me a Coffee, send your preferred display name. Use “Anonymous” if you prefer privacy.',
  'support.loading': 'Loading supporters…',
  'support.unavailable': 'Supporters list unavailable.',
  'support.tier.supporter.name': 'Supporter',
  'support.tier.supporter.perk1': 'Your name in the supporters list',
  'support.tier.contributor.name': 'Contributor',
  'support.tier.contributor.perk1': 'Request an export target mapping',
  'support.tier.sponsor.name': 'Sponsor',
  'support.tier.sponsor.perk1': 'Priority mapping request',
  'support.tier.sponsor.perk2': 'Early access dataset builds',
  'license.kicker': 'License & Rights',
  'license.title': 'MIT License',
  'license.subtitle': 'Use, modify, and distribute ThemeDatabase with minimal restrictions.',
  'license.allowsTitle': 'What this allows',
  'license.allowCommercial': 'Commercial use',
  'license.allowModify': 'Modification and derivative work',
  'license.allowDistribute': 'Distribution and sublicensing',
  'license.allowPrivate': 'Private and internal use',
  'license.conditionsTitle': 'Conditions',
  'license.conditionNotice': 'Keep the original copyright and permission notice.',
  'license.conditionInclude': 'Include this license text in all substantial copies.',
  'license.disclaimerTitle': 'Liability & Warranty',
  'license.disclaimerBody': 'The software is provided "as is", without warranty of any kind.',
  'license.fullTextTitle': 'Full MIT Text (Canonical)',
  'license.copy': 'Copy License',
  'license.copied': 'Copied',
  'license.backAbout': 'Back to About',

  'export.field.editorBackground': 'Editor Background',
  'export.field.editorForeground': 'Editor Foreground',
  'export.field.caret': 'Caret / Cursor',
  'export.field.selectionBackground': 'Selection Background',
  'export.field.selectionForeground': 'Selection Foreground',
  'export.field.currentLine': 'Current Line',
  'export.field.invisibles': 'Invisibles / Whitespace',
  'export.field.indentGuide': 'Indent Guide',
  'export.field.indentGuideActive': 'Indent Guide (Active)',
  'export.field.lineNumbers': 'Line Numbers',
  'export.field.lineNumbersActive': 'Active Line Number',
  'export.field.gutterBackground': 'Gutter Background',
  'export.field.comment': 'Comment',
  'export.field.commentDoc': 'Documentation Comment',
  'export.field.commentDocKeyword': 'Documentation Comment Keyword',
  'export.field.blockComment': 'Block Comment',
  'export.field.string': 'String',
  'export.field.keyword': 'Keyword',
  'export.field.function': 'Function',
  'export.field.functionSystem': 'Function (System)',
  'export.field.variable': 'Variable',
  'export.field.variableSystem': 'Variable (System)',
  'export.field.number': 'Number / Constant',
  'export.field.type': 'Type',
  'export.field.typeSystem': 'Type (System)',
  'export.field.operator': 'Operator',
  'export.field.consoleBackground': 'Console Background',
  'export.field.consoleForeground': 'Console Foreground',
  'export.field.ansiBlack': 'ANSI Black',
  'export.field.ansiRed': 'ANSI Red',
  'export.field.ansiGreen': 'ANSI Green',
  'export.field.ansiYellow': 'ANSI Yellow',
  'export.field.ansiBlue': 'ANSI Blue',
  'export.field.ansiMagenta': 'ANSI Magenta',
  'export.field.ansiCyan': 'ANSI Cyan',
  'export.field.ansiWhite': 'ANSI White',
  'export.field.ansiBrightBlack': 'ANSI Bright Black',
  'export.field.ansiBrightRed': 'ANSI Bright Red',
  'export.field.ansiBrightGreen': 'ANSI Bright Green',
  'export.field.ansiBrightYellow': 'ANSI Bright Yellow',
  'export.field.ansiBrightBlue': 'ANSI Bright Blue',
  'export.field.ansiBrightMagenta': 'ANSI Bright Magenta',
  'export.field.ansiBrightCyan': 'ANSI Bright Cyan',
  'export.field.ansiBrightWhite': 'ANSI Bright White',
};

// Keep non-English packs compact; keys not present fall back to English.
const MESSAGES: Record<Locale, Record<string, string>> = {
  en: EN_MESSAGES,
  tr: {
    ...EN_MESSAGES,
    'app.skipToContent': 'İçeriğe geç',
    'app.loading': 'Yükleniyor…',
	    'header.brandSubtitle': 'Global VS Code Tema Gezgini',
	    'header.motto': 'Hepsine hükmedecek tek tema veritabanı.',
	    'header.navThemes': 'Temalar',
	    'header.navAbout': 'Hakkında',
	    'header.navSupport': 'Destekle',
	    'header.language': 'Dil',
	    'supportPopover.title': 'ThemeDatabase Projesini Destekle',
	    'supportPopover.subtitle': 'Platform ve miktar sec. Yeni sekmede acilir.',
	    'supportPopover.methods': 'Destek platformu',
	    'supportPopover.amount': 'Miktar',
	    'supportPopover.custom': 'Ozel miktar',
	    'supportPopover.send': 'Devam et (${amount})',
	    'supportPopover.note': 'Not: URL ile ozel miktar desteklenmiyorsa, acilan sayfada tier sec.',
	    'supportPopover.copiedAmount': 'Miktar kopyalandi. Buy Me a Coffee uzerinde miktar alanina yapistir.',
	    'supportPopover.copyFailed': 'Miktar kopyalanamadi. Buy Me a Coffee uzerinde elle gir.',
	    'supportPopover.needsUrl': 'Etkinlestirmek icin supporters.json icinde URL ekle.',
    'hero.subtitle': 'Kod içindeki herhangi bir rengi seç ve tüm tema veritabanında filtrele.',
    'hero.language': 'Örnek Programlama Dili',
    'homePreview.ariaLabel': 'Özellik önizlemesi',
    'homePreview.close': 'Özellik önizlemesini kapat',
    'homePreview.pack.title': 'Tema Paketi Builder',
    'homePreview.pack.body': 'En fazla 10 tema seç ve tek bir VSIX paketi oluştur.',
    'homePreview.pack.meta': 'Seçimler üstte • Tek tıkla paket export',
    'homePreview.pack.cta': 'Tema Paketi Builder',
    'homePreview.export.title': 'Çoklu hedef dışa aktarım',
    'homePreview.export.body': 'Aynı temayı VS Code, JetBrains, Xcode, Vim ve Emacs için dışa aktar.',
    'homePreview.export.meta': 'Strict 1:1 eşleme • Alan bazlı override',
    'homePreview.export.cta': 'Builder\'ı aç',
    'homePreview.export.ctaDisabledHint': 'Builder için bir tema seç.',
    'home.filterResult': 'Filtre sonucu: {count} tema',
    'home.resetFilters': 'Filtreleri Sıfırla',
    'home.selected': 'Seçili: {count}/{max}',
    'home.openPackBuilder': 'Tema Paketi Builder',
    'home.selectedSection': 'Seçilen Temalar',
    'home.clearSelected': 'Seçimi temizle',
    'pack.title': 'Tema Paketi Builder',
    'pack.subtitle': 'Seçtiğin temaları tek bir VSIX içine aktar.',
    'pack.identityTitle': 'Extension kimliği',
    'pack.field.publisher': 'Yayıncı',
    'pack.field.version': 'Versiyon',
    'pack.field.displayName': 'Görünen ad',
    'pack.field.name': 'Ad (benzersiz id)',
    'pack.field.description': 'Açıklama',
    'pack.emptyTitle': 'Seçili tema yok',
    'pack.emptyBody': 'Explorer’da en fazla 10 tema seç, sonra burada tek bir VSIX paketi oluştur.',
    'pack.back': 'Explorer’a dön',
    'pack.generate': 'VSIX Oluştur & İndir',
    'pack.loading': 'Seçilen temalar yükleniyor…',
    'pack.limitReached': 'En fazla {max} tema seçebilirsin.',
    'pack.includedTitle': 'Dahil edilen temalar',
    'pack.included': '{count} tema dahil',
    'pack.selectedTitle': 'Seçilen temalar',
    'loading.shards': 'Shard yükleme: {loaded}/{total} ({ratio}%)',
    'card.details': 'Detay',
    'card.previewUnavailable': 'Önizleme yok',
    'card.select': '{name} seç',
    'card.deselect': '{name} seçimini kaldır',
    'filters.search': 'Ara',
    'filters.bgCategory': 'Arkaplan Kategorisi',
    'filters.tokenRole': 'Token Rolü',
    'filters.openPalette': 'Renk paletini aç',
    'filters.paletteTitle': 'Renk Paleti',
    'filters.palette.warm': 'Sıcak Tonlar',
    'filters.palette.cool': 'Soğuk Tonlar',
    'filters.palette.deep': 'Derin Tonlar',
    'filters.palette.neutral': 'Nötr Tonlar',
    'filters.close': 'Kapat',
    'filters.customColor': 'Özel Renk',
    'filters.customColorAria': 'Özel renk seç',
    'filters.sort': 'Sıralama',
    'filters.view': 'Görünüm',
    'filters.sort.name': 'İsim',
    'detail.loading': 'Tema detayı yükleniyor…',
    'detail.notFound': 'Tema bulunamadı.',
    'detail.backToList': 'Listeye dön',
    'detail.previewLabel': 'IDE Önizleme',
    'detail.previewStatus': 'Tanılama hatası yok',
    'detail.similarThemes': 'Benzer Temalar',
    'builder.loading': 'Builder verisi yükleniyor…',
	    'builder.payloadLoadFailed': 'VSIX payload yüklenemedi.',
    'builder.themeOrPayloadNotFound': 'Tema veya payload bulunamadı.',
	    'builder.vsixBuildFailed': 'VSIX oluşturulamadı.',
	    'builder.previewExportPlan': 'Bu hedef için eşleme planı ve dahil edilen alanlar.',
	    'builder.exportTarget': 'Dışa Aktarım Hedefi',
	    'builder.target.vscode': 'VS Code (VSIX)',
	    'builder.target.jetbrainsPlugin': 'JetBrains (Plugin .zip)',
	    'builder.target.jetbrainsIcls': 'JetBrains (Şema .icls)',
	    'builder.target.xcode': 'Xcode (.dvtcolortheme)',
	    'builder.target.xcodeXc': 'Xcode (.xccolortheme)',
	    'builder.target.vim': 'Vim (.vim)',
	    'builder.target.emacs': 'Emacs (theme.el)',
	    'builder.exportPreview': 'Export Önizleme',
	    'builder.configureExportTitle': 'Export Ayarları',
	    'builder.configureExportSubtitle': 'Tema parametrelerini strict 1:1 kurallarıyla IDE formatına eşle.',
	    'builder.coverage': '{included} alan export edilecek, {excluded} alan yok',
	    'builder.exportIdentity': 'Export Kimliği',
	    'builder.exportDisplayName': 'Görünen Ad',
	    'builder.exportFilename': 'Dosya Adı (Slug)',
	    'builder.exportFields': 'Export Alanları',
	    'builder.group.editor': 'Editör',
	    'builder.group.syntax': 'Syntax',
	    'builder.group.console': 'Konsol',
	    'builder.resetField': 'Sıfırla',
	    'builder.overridden': 'Override',
	    'builder.mapped': 'Eşlendi',
	    'builder.source': 'Kaynak',
	    'builder.alphaNotSupported': 'Bu hedef alan için alpha desteklenmiyor.',
	    'builder.invalidColor': 'Geçersiz renk değeri.',
	    'builder.exportPlanMissing': 'Export planı oluşturulamadı.',
	    'builder.overrideFixRequired': 'Export öncesi geçersiz override değerlerini düzeltin.',
	    'builder.exportBuildFailed': 'Export oluşturulamadı.',
	    'builder.generateExport': 'Oluştur ve İndir',
	    'success.exportReady': 'Export Hazır!',
	    'success.downloadFile': 'Dosyayı indir',
	    'success.target.vscode-vsix': 'Hedef: VS Code',
	    'success.target.jetbrains-plugin': 'Hedef: JetBrains Plugin',
	    'success.target.jetbrains-icls': 'Hedef: JetBrains Şema',
	    'success.target.xcode-dvtcolortheme': 'Hedef: Xcode',
	    'success.target.xcode-xccolortheme': 'Hedef: Xcode',
	    'success.target.vim-colorscheme': 'Hedef: Vim',
	    'success.target.emacs-theme': 'Hedef: Emacs',
	  'success.generatedFor': '{name} için paket başarıyla oluşturuldu.',
    'about.liveBadge': 'Canlı İndeksleme: Aktif',
    'about.heroSubtitle': 'Global VS Code ekosisteminde analiz edilen temalar. Hassas eşleşme için tüm renk anahtarlarını indeksliyoruz.',
    'about.statExtensions': 'Eklenti',
    'about.statColorKeys': 'Renk Anahtarı',
    'about.statDailyUpdates': 'Günlük Güncelleme',
    'about.statQueryTime': 'Sorgu Süresi',
    'about.algorithmKicker': 'Algoritmik Çekirdek',
    'about.algorithmTitle': 'HSL Renk Eşleştirme Motoru',
    'about.algorithmBody': 'ThemeDatabase renkleri HSL uzayına çevirir ve algısal olarak daha doğru sonuçlar için Delta-E mesafesi hesaplar.',
    'about.engineDeltaTitle': 'Delta-E Hesabı',
    'about.engineDeltaBody': 'Güvenilir görsel benzerlik için CIE tabanlı renk uzaklığı eşleştirmesi.',
    'about.enginePerceptualTitle': 'Algısal Tutarlılık',
    'about.enginePerceptualBody': 'İnsan gözünün kontrast ve parlaklık algısını temel alır.',
    'about.databaseKicker': 'Veritabanı',
    'about.databaseTitle': 'Global İndeks',
    'about.extensionsTracked': 'İzlenen Eklentiler',
    'about.colorKeysTracked': 'Renk Anahtarları',
    'about.performanceKicker': 'Performans Mimarisi',
    'about.performanceTitle': 'Motoru Tanıyın',
    'about.performanceBody': 'Statik shard yükleme ve sanallaştırılmış listeleme ile düşük gecikmeli gezinme.',
    'about.perfClientTitle': 'İstemci Tarafı İşleme',
    'about.perfClientBody': 'Backend gerektirmeden tamamen tarayıcıda çalışır.',
    'about.perfShardTitle': 'Parçalı Veri Yükleme',
    'about.perfShardBody': 'İlk render performansı için sadece gerekli parçaları yükler.',
    'about.perfVirtualizedTitle': 'Sanallaştırılmış Listeler',
    'about.perfVirtualizedBody': 'Büyük sonuç setlerinde kaydırma akıcı kalır.',
    'about.licenseKicker': 'Açık Kaynak',
    'about.licenseTitle': 'MIT Lisansı',
	    'about.licenseBody': 'Bu proje açık kullanım ve değişiklik için MIT Lisansı ile lisanslanmıştır.',
	    'about.licenseView': 'LICENSE Görüntüle',
	    'support.kicker': 'Destek',
	    'support.title': 'ThemeDatabase Projesini Destekle',
	    'support.body': 'Destekleriniz veri setinin guncel kalmasina, onizlemelerin barinmasina ve yeni exporter hedeflerinin gelismesine yardimci olur.',
	    'support.cta': 'Buy Me a Coffee uzerinden destekle',
	    'support.tiersTitle': 'Uyelik Seviyeleri',
	    'support.thanksTitle': 'Tesekkurler',
	    'support.howTitle': 'Listeye nasil girerim?',
	    'support.howBody': 'Buy Me a Coffee uzerinden destekledikten sonra gorunecek isminizi iletin. Isterseniz “Anonymous” secin.',
	    'support.loading': 'Destekleyenler yukleniyor…',
	    'support.unavailable': 'Destekleyenler listesi su an kullanilamiyor.',
	    'support.tier.supporter.name': 'Supporter',
	    'support.tier.supporter.perk1': 'Destekleyenler listesinde isminiz',
	    'support.tier.contributor.name': 'Contributor',
	    'support.tier.contributor.perk1': 'Export hedefi esleme talebi',
	    'support.tier.sponsor.name': 'Sponsor',
	    'support.tier.sponsor.perk1': 'Oncelikli esleme talebi',
	    'support.tier.sponsor.perk2': 'Erken dataset build erisimi',
	    'license.kicker': 'Lisans ve Haklar',
    'license.title': 'MIT Lisansı',
    'license.subtitle': 'ThemeDatabase projesini minimum kısıtla kullanabilir, değiştirebilir ve dağıtabilirsiniz.',
    'license.allowsTitle': 'Sağlanan haklar',
    'license.allowCommercial': 'Ticari kullanım',
    'license.allowModify': 'Değiştirme ve türev üretme',
    'license.allowDistribute': 'Dağıtım ve alt lisanslama',
    'license.allowPrivate': 'Özel ve kurum içi kullanım',
    'license.conditionsTitle': 'Koşullar',
    'license.conditionNotice': 'Orijinal telif ve izin bildirimini korumalısınız.',
    'license.conditionInclude': 'Bu lisans metnini tüm önemli kopyalara eklemelisiniz.',
    'license.disclaimerTitle': 'Sorumluluk ve Garanti',
    'license.disclaimerBody': 'Yazılım "olduğu gibi" sunulur ve herhangi bir garanti vermez.',
    'license.fullTextTitle': 'MIT Tam Metin (Kanonik)',
    'license.copy': 'Lisansı Kopyala',
    'license.copied': 'Kopyalandı',
	    'license.backAbout': 'Hakkında sayfasına dön',
  },
  de: {
    ...EN_MESSAGES,
    'app.skipToContent': 'Zum Inhalt springen',
    'app.loading': 'Wird geladen…',
    'header.brandSubtitle': 'Globaler VS Code Theme-Explorer',
    'header.motto': 'Eine Theme-Datenbank, sie alle zu beherrschen.',
    'header.navMain': 'Hauptnavigation',
    'header.navThemes': 'Themen',
    'header.navAbout': 'Über',
    'header.navSupport': 'Support',
    'header.language': 'Sprache',
    'hero.title': 'Globale Theme-Datenbank',
    'hero.subtitle': 'Wähle eine Farbe aus Code und filtere über die gesamte Theme-Datenbank.',
    'hero.language': 'Beispiel-Programmiersprache',
    'home.explorer': 'Theme-Explorer',
    'home.filterResult': 'Filterergebnis: {count} Themes',
    'home.resetFilters': 'Filter zurücksetzen',
    'filters.search': 'Suche',
    'filters.searchPlaceholder': 'Theme, Publisher, Beschreibung…',
    'filters.bgCategory': 'Hintergrund-Kategorie',
    'filters.tokenRole': 'Token-Rolle',
    'filters.openPalette': 'Farbpalette öffnen',
    'filters.paletteTitle': 'Farbpalette',
    'filters.close': 'Schließen',
    'card.details': 'Details',
    'card.previewUnavailable': 'Vorschau nicht verfügbar',
  },
  fr: {
    ...EN_MESSAGES,
    'app.skipToContent': 'Aller au contenu',
    'app.loading': 'Chargement…',
    'header.brandSubtitle': 'Explorateur global de thèmes VS Code',
    'header.motto': 'Une base de thèmes pour les gouverner tous.',
    'header.navMain': 'Navigation principale',
    'header.navThemes': 'Thèmes',
    'header.navAbout': 'À propos',
    'header.navSupport': 'Support',
    'header.language': 'Langue',
    'hero.title': 'Base de thèmes globale',
    'hero.subtitle': 'Choisissez une couleur depuis du code et filtrez toute la base de thèmes.',
    'hero.language': 'Langage de programmation (exemple)',
    'home.explorer': 'Explorateur de thèmes',
    'home.filterResult': 'Résultat du filtre : {count} thèmes',
    'home.resetFilters': 'Réinitialiser les filtres',
    'filters.search': 'Rechercher',
    'filters.searchPlaceholder': 'Thème, éditeur, description…',
    'filters.bgCategory': 'Catégorie d’arrière-plan',
    'filters.tokenRole': 'Rôle du token',
    'filters.openPalette': 'Ouvrir la palette de couleurs',
    'filters.paletteTitle': 'Palette de couleurs',
    'filters.close': 'Fermer',
    'card.details': 'Détails',
    'card.previewUnavailable': 'Aperçu indisponible',
  },
  zh: {
    ...EN_MESSAGES,
    'app.skipToContent': '跳到内容',
    'app.loading': '加载中…',
    'header.brandSubtitle': '全局 VS Code 主题浏览器',
    'header.motto': '一库统御所有主题。',
    'header.navMain': '主导航',
    'header.navThemes': '主题',
    'header.navAbout': '关于',
    'header.navSupport': '支持',
    'header.language': '语言',
    'hero.title': '全局主题数据库',
    'hero.subtitle': '从代码中选择任意颜色，在整个主题库中筛选。',
    'hero.language': '示例编程语言',
    'home.explorer': '主题浏览',
    'home.filterResult': '筛选结果：{count} 个主题',
    'home.resetFilters': '重置筛选',
    'filters.search': '搜索',
    'filters.searchPlaceholder': '主题、发布者、描述…',
    'filters.bgCategory': '背景分类',
    'filters.tokenRole': 'Token 角色',
    'filters.openPalette': '打开调色板',
    'filters.paletteTitle': '调色板',
    'filters.close': '关闭',
    'card.details': '详情',
    'card.previewUnavailable': '预览不可用',
  },
  ja: {
    ...EN_MESSAGES,
    'app.skipToContent': '本文へスキップ',
    'app.loading': '読み込み中…',
    'header.brandSubtitle': 'グローバル VS Code テーマ探索',
    'header.motto': 'すべてを支配する一つのテーマデータベース。',
    'header.navMain': 'メインナビゲーション',
    'header.navThemes': 'テーマ',
    'header.navAbout': '概要',
    'header.navSupport': 'サポート',
    'header.language': '言語',
    'hero.title': 'グローバル テーマデータベース',
    'hero.subtitle': 'コードから色を選び、全テーマデータベースでフィルタリング。',
    'hero.language': 'サンプル言語',
    'home.explorer': 'テーマ探索',
    'home.filterResult': 'フィルター結果：{count} テーマ',
    'home.resetFilters': 'フィルターをリセット',
    'filters.search': '検索',
    'filters.searchPlaceholder': 'テーマ、発行者、説明…',
    'filters.bgCategory': '背景カテゴリ',
    'filters.tokenRole': 'トークン役割',
    'filters.openPalette': 'カラーパレットを開く',
    'filters.paletteTitle': 'カラーパレット',
    'filters.close': '閉じる',
    'card.details': '詳細',
    'card.previewUnavailable': 'プレビューは利用できません',
  },
  ko: {
    ...EN_MESSAGES,
    'app.skipToContent': '본문으로 건너뛰기',
    'app.loading': '로딩 중…',
    'header.brandSubtitle': '글로벌 VS Code 테마 탐색기',
    'header.motto': '모든 테마를 지배할 단 하나의 데이터베이스.',
    'header.navMain': '주 탐색',
    'header.navThemes': '테마',
    'header.navAbout': '소개',
    'header.navSupport': '지원',
    'header.language': '언어',
    'hero.title': '글로벌 테마 데이터베이스',
    'hero.subtitle': '코드에서 색을 고르고 전체 테마 DB에서 필터링하세요.',
    'hero.language': '샘플 프로그래밍 언어',
    'home.explorer': '테마 탐색',
    'home.filterResult': '필터 결과: {count}개 테마',
    'home.resetFilters': '필터 초기화',
    'filters.search': '검색',
    'filters.searchPlaceholder': '테마, 퍼블리셔, 설명…',
    'filters.bgCategory': '배경 카테고리',
    'filters.tokenRole': '토큰 역할',
    'filters.openPalette': '색상 팔레트 열기',
    'filters.paletteTitle': '색상 팔레트',
    'filters.close': '닫기',
    'card.details': '상세',
    'card.previewUnavailable': '미리보기를 사용할 수 없음',
  },
  ar: {
    ...EN_MESSAGES,
    'header.language': 'اللغة',
    'home.resetFilters': 'إعادة ضبط الفلاتر',
    'card.details': 'التفاصيل',
    'app.skipToContent': 'تجاوز إلى المحتوى',
  },
  es: {
    ...EN_MESSAGES,
    'header.language': 'Idioma',
    'header.navAbout': 'Acerca de',
    'header.navSupport': 'Apoyar',
    'home.resetFilters': 'Restablecer filtros',
    'home.filterResult': 'Resultado del filtro: {count} temas',
    'filters.search': 'Buscar',
    'filters.close': 'Cerrar',
    'card.details': 'Detalles',
  },
  pt: {
    ...EN_MESSAGES,
    'header.language': 'Idioma',
    'header.navAbout': 'Sobre',
    'header.navSupport': 'Apoiar',
    'home.resetFilters': 'Redefinir filtros',
    'home.filterResult': 'Resultado do filtro: {count} temas',
    'filters.search': 'Buscar',
    'filters.close': 'Fechar',
    'card.details': 'Detalhes',
  },
  hi: {
    ...EN_MESSAGES,
    'header.language': 'भाषा',
    'header.navAbout': 'परिचय',
    'header.navSupport': 'सपोर्ट',
    'home.resetFilters': 'फ़िल्टर रीसेट करें',
    'home.filterResult': 'फ़िल्टर परिणाम: {count} थीम्स',
    'filters.search': 'खोजें',
    'filters.close': 'बंद करें',
    'card.details': 'विवरण',
  },
};

const I18nContext = createContext<I18nContextValue | null>(null);

function interpolate(input: string, vars?: Record<string, string | number>): string {
  if (!vars) {
    return input;
  }
  // Support both `{var}` and `${var}` placeholders.
  return input.replace(/\$\{(\w+)\}|\{(\w+)\}/g, (_, k1: string, k2: string) => {
    const key = k1 || k2;
    return `${vars[key] ?? ''}`;
  });
}

export function I18nProvider({ children }: PropsWithChildren) {
  const [locale, setLocale] = useState<Locale>(() => {
    const saved = localStorage.getItem('tdb-locale') as Locale | null;
    if (saved && saved in LOCALE_LABELS) {
      return saved;
    }
    return 'en';
  });

  useEffect(() => {
    localStorage.setItem('tdb-locale', locale);
    document.documentElement.lang = locale;
    document.documentElement.dir = RTL_LOCALES.includes(locale) ? 'rtl' : 'ltr';
  }, [locale]);

  const value = useMemo<I18nContextValue>(() => ({
    locale,
    setLocale,
    t: (key, vars) => {
      const fromLocale = MESSAGES[locale]?.[key];
      const fallback = EN_MESSAGES[key];
      const text = fromLocale ?? fallback ?? key;
      return interpolate(text, vars);
    },
    formatNumber: (num) => num.toLocaleString(NUMBER_LOCALE[locale] ?? 'en-US'),
  }), [locale]);

  return <I18nContext.Provider value={value}>{children}</I18nContext.Provider>;
}

export function useI18n(): I18nContextValue {
  const ctx = useContext(I18nContext);
  if (!ctx) {
    throw new Error('useI18n must be used inside I18nProvider');
  }
  return ctx;
}

export const LOCALE_OPTIONS = Object.entries(LOCALE_LABELS).map(([value, label]) => ({
  value: value as Locale,
  label,
}));
